(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{9366:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return _}});var a=i(5893),o=i(7294),r=i(6744),n=i(1114),l=i(4726),s=i(8872),d=i(6074),p=i(2127),c=i(6342),x=i(7484),h=i.n(x),g=i(9828);let u=(0,i(3977).ZF)({apiKey:"AIzaSyBVMiI8xBNFtompSGDx4v_okOYwD2hC0Go",authDomain:"mobile-wedding-card-ee13c.firebaseapp.com",projectId:"mobile-wedding-card-ee13c",storageBucket:"mobile-wedding-card-ee13c.firebasestorage.app",messagingSenderId:"10314116911421",appId:"1:1031411691142:web:2a04d709d87e1e546f6b07"}),f=(0,g.ad)(u);var m=i(1354),w=i.n(m);let b=(0,r.zo)("div",{background:"#efebe9",backgroundImage:"url(./assets/GroovePaper.png)",paddingTop:0,paddingBottom:30,width:"100%",textAlign:"center"}),S=(0,r.zo)("p",{fontSize:"150%",fontWeight:"bold",marginBottom:"0px"}),z=(0,r.zo)("div",{fontSize:"14px",color:"#888",margin:"20px 0"}),j=(0,r.zo)("div",{width:"90%",maxWidth:"600px",margin:"0 auto",padding:"20px",background:"#ffffff",borderRadius:"8px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",gap:"16px"}),v=(0,r.zo)("div",{display:"flex",justifyContent:"space-between",gap:"12px",width:"100%"}),y=(0,r.zo)("p",{textAlign:"right",fontSize:"14px",color:"#555",margin:"10px 20px 0 0"}),k=(0,r.zo)("span",{fontSize:"16px",fontWeight:"bold",color:"#000"}),C=(0,r.zo)(n.Z.TextArea,{width:"100%",fontSize:"14px",resize:"none",height:"80px"}),Z=(0,r.zo)(n.Z,{flex:.6}),P=(0,r.zo)(n.Z.Password,{flex:.4}),D=(0,r.zo)(l.ZP,{alignSelf:"flex-end"}),A=(0,r.zo)("div",{width:"90%",maxWidth:"600px",margin:"20px auto 0",textAlign:"left",display:"flex",flexDirection:"column",gap:"8px"}),B=(0,r.zo)("div",{width:"100%",background:"#ffffff",padding:"4px 8px",borderRadius:"8px",position:"relative",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.1)"}),I=(0,r.zo)("p",{fontSize:"14px",fontWeight:"bold",marginBottom:"4px"}),E=(0,r.zo)("p",{fontSize:"13px",opacity:.9,margin:"8px 0",wordBreak:"break-word",whiteSpace:"pre-wrap"}),H=(0,r.zo)("p",{fontSize:"12px",color:"#888",position:"absolute",top:"6px",right:"8px"}),W=(0,r.zo)(l.ZP,{position:"absolute",bottom:"6px",right:"8px",fontSize:"12px"}),Y=w().SHA256("admin1").toString();function _(){let[e,t]=(0,o.useState)([]),[i,r]=(0,o.useState)(!0),[l,x]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),[_,F]=(0,o.useState)(""),[O,T]=(0,o.useState)(!1),[G,J]=(0,o.useState)(null),[M,N]=(0,o.useState)(""),[R,K]=(0,o.useState)(1),L=async()=>{try{let e=await (0,g.PL)((0,g.hJ)(f,"guestbook")),i=[];e.forEach(e=>{i.push({...e.data(),id:e.id})});let a=i.sort((e,t)=>h()(t.time).valueOf()-h()(e.time).valueOf());t(a)}catch(e){console.error("Firestore에서 메시지를 가져오는 중 오류:",e),r(!1)}};(0,o.useEffect)(()=>{L()},[]);let U=async()=>{if(!l.trim()||!u.trim()||!_.trim()){s.ZP.warning("이름, 내용, 비밀번호 모두 입력해주세요!");return}let e=w().SHA256(_).toString(),t={name:l.trim(),content:u.trim(),time:h()().format("YYYY-MM-DD HH:mm"),hashedPassword:e};try{await (0,g.ET)((0,g.hJ)(f,"guestbook"),t),s.ZP.success("새로운 메시지가 추가되었습니다!"),x(""),m(""),F(""),L()}catch(e){console.error("Firestore에 메시지 추가 중 오류:",e),s.ZP.error("메시지를 추가하지 못했습니다.")}};if(!i)return(0,a.jsxs)(b,{children:[(0,a.jsxs)(d.Z,{plain:!0,style:{margin:0},children:[" ",(0,a.jsx)(S,{children:"축하글"})]}),(0,a.jsx)(z,{children:"현재 방명록 데이터를 불러올 수 없습니다. 나중에 다시 시도해 주세요. \uD83D\uDC8C"})]});let V=e.slice((R-1)*10,10*R);return(0,a.jsxs)(b,{children:[(0,a.jsxs)(d.Z,{plain:!0,style:{margin:0},children:[" ",(0,a.jsx)(S,{children:"축하해주세요"})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(v,{children:[(0,a.jsx)(Z,{placeholder:"이름",value:l,onChange:e=>x(e.target.value),allowClear:!0}),(0,a.jsx)(P,{placeholder:"비밀번호",value:_,onChange:e=>F(e.target.value),allowClear:!0})]}),(0,a.jsx)(C,{placeholder:"내용을 입력해주세요 (최대 200자, 30줄)",value:u,onChange:e=>{let t=e.target.value;if(t.length>200){m(t.slice(0,200));return}let i=t.split("\n");if(i.length>30){m(i.slice(0,30).join("\n"));return}m(t)},allowClear:!0}),(0,a.jsx)(D,{type:"primary",onClick:U,children:"축하 남기기"})]}),(0,a.jsxs)(y,{children:[(0,a.jsxs)(k,{children:[e.length,"개"]})," 의 축하를 받았어요!"]}),(0,a.jsx)(A,{children:V.map(e=>(0,a.jsxs)(B,{children:[(0,a.jsx)(H,{children:e.time}),(0,a.jsx)(I,{children:e.name}),(0,a.jsx)(E,{children:e.content}),(0,a.jsx)(W,{danger:!0,type:"text",onClick:()=>{J({id:e.id,hashedPassword:e.hashedPassword}),T(!0)},children:"삭제"})]},e.id))}),(0,a.jsx)(p.Z,{current:R,pageSize:10,total:e.length,onChange:e=>{K(e)},style:{marginTop:"20px"}}),(0,a.jsx)(c.Z,{title:"메시지 삭제",visible:O,onCancel:()=>{T(!1),N("")},onOk:async()=>{if(!G)return;let e=w().SHA256(M).toString();if(e===G.hashedPassword||e===Y)try{await (0,g.oe)((0,g.JU)(f,"guestbook",G.id)),s.ZP.success("메시지가 삭제되었습니다!"),L(),T(!1),N("")}catch(e){s.ZP.error("메시지 삭제에 실패했습니다.")}else s.ZP.error("비밀번호가 일치하지 않습니다.")},children:(0,a.jsx)(n.Z.Password,{placeholder:"비밀번호를 입력하세요",value:M,onChange:e=>N(e.target.value),allowClear:!0})})]})}},2480:function(){}}]);